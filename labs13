//  Запись данных 
#include <iostream>
#include <fstream>
#include <locale>
using namespace std;
int main() {
    setlocale(0, ".1251");
    sofstream outfile("numbers.bin", ios::binary);
    if (!outfile) {
        cerr << "Не удалось открыть файл для записи." << endl;
        return 1;
    }
    // Записываем числа
    int numbers[] = { 67, 14, 23, 5, 100 };
    for (int num : numbers) {
        outfile.write(reinterpret_cast<const char*>(&num), sizeof(int));
    }
    cout << "Числа успешно записаны в файл." << endl;
    return 0;
}

// 2.2
#include <iostream>
#include <fstream>
#include <string>
#include <locale>
using namespace std;

int main() {
    setlocale(0, ".1251");
    string filename;
    cout << "Введите имя бинарного файла: ";
    cin >> filename;

    ifstream infile(filename, ios::binary);
    if (!infile) {
        cerr << "Ошибка при открытии файла." << endl;
        return 1;
    }
    int number;
    int count = 0;
    long long sum = 0; 
    int index = 1;
    while (infile.read(reinterpret_cast<char*>(&number), sizeof(int))) {
        cout << index << ") " << number << endl;
        sum += number;
        count++;
        index++;
    }
    if (infile.eof()) {
        if (count > 0) {
            double average = static_cast<double>(sum) / count;
            cout << "Среднее значение " << average << endl;
        }
        else {
            cout << "Файл не содержит целых чисел." << endl;
        }
    }
    else {
        cerr << "Ошибка чтения файла или некорректные данные." << endl;
        return 1;
    }
    return 0;
}

// 2.3
#include <iostream>
#include <fstream>
#include <locale> 
using namespace std;

struct Student {
    char surname[50];
    char name[50];
    int age;
    double avgGrade;
};

int main() {
    setlocale(0, ".1251");
    Student students[] = {
        {"Иванов", "Иван", 20, 4.5},
        {"Петрова", "Анна", 21, 4.7},
        {"Смирнов", "Алексей", 19, 3.9},
        {"Козлова", "Ольга", 22, 4.2}
    };
    size_t num_students = sizeof(students) / sizeof(students[0]);
    ofstream outfile("students.bin", ios::binary);
    if (!outfile) {
        cerr << "Ошибка при открытии файла для записи." << endl;
        return 1;
    }
    for (size_t i = 0; i < num_students; ++i) {
        outfile.write(reinterpret_cast<const char*>(&students[i]), sizeof(Student));
    }
    outfile.close();
    cout << "Данные успешно записаны в файл students.bin" << endl;
    return 0;
}

// 2.4
#include <iostream>
#include <fstream>
#include <locale> 
using namespace std;

struct Student {
    char surname[50];
    char name[50];
    int age;
    double avgGrade;
};

int main() {
    setlocale(0, ".1251");
    string filename;
    cout << "Введите имя бинарного файла: ";
    cin >> filename;

    ifstream infile(filename, ios::binary);
    if (!infile) {
        cerr << "Ошибка при открытии файла " << filename << endl;
        return 1;
    }
    infile.seekg(0, ios::end);
    long fileSize = infile.tellg();
    infile.seekg(0, ios::beg);
    size_t num_students = fileSize / sizeof(Student);
    Student* students = new Student[num_students];
    for (size_t i = 0; i < num_students; ++i) {
        infile.read(reinterpret_cast<char*>(&students[i]), sizeof(Student));
    }
    infile.close();
    cout << "Считанные данные о студентах:" << endl;
    for (size_t i = 0; i < num_students; ++i) {
        cout << "Фамилия: " << students[i].surname;
        cout << ", Имя: " << students[i].name;
        cout << ", Возраст: " << students[i].age;
        cout << ", Средний балл: " << students[i].avgGrade << endl;
    }
    delete[] students;
    return 0;
}
